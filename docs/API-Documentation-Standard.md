# AstroRead API 文档规范

> 本文档定义了 AstroRead 项目 API 文档的编写规范和模板

## 文档结构

每个 API 模块文档应包含以下部分：

1. **概述** - 模块简介和主要功能
2. **接口清单** - 所有公开接口的列表
3. **详细接口说明** - 每个接口的详细文档
4. **数据模型** - 相关的数据类型定义
5. **错误码** - 可能的错误码及解决方案
6. **使用示例** - 完整的调用示例
7. **变更日志** - 接口变更记录

---

## 接口文档模板

```markdown
# [模块名称] API 文档

> [模块简介]

## 目录

- [接口清单](#接口清单)
- [数据模型](#数据模型)
- [接口详情](#接口详情)
- [错误码](#错误码)
- [使用示例](#使用示例)

---

## 接口清单

| 接口名称 | HTTP方法 | URL路径 | 功能描述 |
|---------|---------|---------|---------|
| [接口名] | GET/POST | /api/path | [简短描述] |

---

## 数据模型

### [模型名称]

```typescript
interface ModelName {
  // 字段说明
  fieldName: string;  // 字段描述
}
```

| 字段名 | 类型 | 必填 | 默认值 | 说明 |
|-------|------|-----|--------|------|
| fieldName | string | 是 | - | 字段说明 |

---

## 接口详情

### [接口名称]

**基本信息**

| 属性 | 值 |
|-----|-----|
| 接口名称 | [名称] |
| 请求方法 | GET/POST/PUT/DELETE |
| 请求路径 | /api/path |
| 接口描述 | [详细描述] |
| 认证方式 | [认证说明] |

**请求参数**

| 参数名 | 位置 | 类型 | 必填 | 默认值 | 说明 |
|-------|------|------|-----|--------|------|
| param | query/body/path | string | 是 | - | 参数说明 |

**请求示例**

```typescript
// 请求代码示例
```

**响应参数**

| 字段名 | 类型 | 说明 |
|-------|------|------|
| field | string | 字段说明 |

**成功响应示例**

```json
{
  "code": 0,
  "message": "success",
  "data": {
    // 响应数据
  }
}
```

**错误响应示例**

```json
{
  "code": 10001,
  "message": "错误描述",
  "data": null
}
```

---

## 错误码

| 错误码 | 描述 | 解决方案 |
|-------|------|---------|
| 10001 | 错误描述 | 解决方案说明 |

---

## 使用示例

### 场景一：[场景描述]

```typescript
// 完整示例代码
```

### 场景二：[场景描述]

```typescript
// 完整示例代码
```
```

---

## 命名规范

### 接口命名

- 使用小驼峰命名法：`getUserInfo`、`searchBooks`
- 使用动词开头：`get`、`create`、`update`、`delete`、`search`
- 语义清晰：避免缩写，使用完整单词

### 参数命名

- 使用小驼峰命名法：`userId`、`bookName`
- 布尔类型使用 `is`、`has`、`can` 前缀：`isEnabled`、`hasCover`
- 时间戳使用 `Time` 后缀：`createTime`、`updateTime`
- 数量使用 `Count` 后缀：`chapterCount`、`wordCount`

### 响应格式

```typescript
interface ApiResponse<T> {
  code: number;        // 状态码，0 表示成功
  message: string;     // 状态信息
  data: T | null;      // 响应数据
  timestamp: number;   // 响应时间戳
}
```

---

## 错误码规范

### 错误码格式

错误码采用 5 位数字格式：`AABBC`

- `AA`：模块代码
- `BB`：错误类型
- `C`：具体错误

### 模块代码

| 模块 | 代码 |
|------|------|
| 通用 | 00 |
| 用户 | 01 |
| 书籍 | 02 |
| 书源 | 03 |
| 阅读 | 04 |
| 网络 | 05 |
| 数据库 | 06 |
| 解析器 | 07 |

### 错误类型

| 类型 | 代码 |
|------|------|
| 参数错误 | 01 |
| 权限错误 | 02 |
| 资源不存在 | 03 |
| 操作失败 | 04 |
| 系统错误 | 05 |

### 常用错误码

| 错误码 | 描述 |
|-------|------|
| 00000 | 成功 |
| 00001 | 未知错误 |
| 00101 | 参数缺失 |
| 00102 | 参数格式错误 |
| 00201 | 未授权访问 |
| 00202 | 权限不足 |
| 00301 | 资源不存在 |
| 00501 | 网络请求失败 |
| 00502 | 网络超时 |
| 00601 | 数据库操作失败 |
| 00701 | 解析失败 |

---

## 文档更新机制

### 更新触发条件

1. **新增接口** - 新增公开 API 时必须同步更新文档
2. **接口变更** - 参数、返回值、行为发生变化时更新
3. **接口废弃** - 标记为废弃，说明替代方案
4. **错误码变更** - 新增或修改错误码时更新

### 版本控制

- 文档版本号与代码版本号保持一致
- 使用语义化版本：`主版本.次版本.修订版本`
- 主版本：不兼容的 API 变更
- 次版本：向后兼容的功能新增
- 修订版本：向后兼容的问题修复

### 变更日志格式

```markdown
## [版本号] - YYYY-MM-DD

### 新增
- 新增接口：`接口名称` - 功能描述

### 变更
- 变更接口：`接口名称` - 变更描述

### 废弃
- 废弃接口：`接口名称` - 替代方案

### 移除
- 移除接口：`接口名称` - 移除原因

### 修复
- 修复问题：问题描述
```

---

## 文档检查清单

在发布文档前，请确认以下内容：

- [ ] 所有接口都已列出
- [ ] 参数类型和必填项正确
- [ ] 响应格式和字段说明完整
- [ ] 错误码和解决方案准确
- [ ] 示例代码可运行
- [ ] 版本号已更新
- [ ] 变更日志已记录
- [ ] 无错别字和格式错误

---

> 文档版本: v1.0.0  
> 最后更新: 2026-02-17
