# AstroRead - HarmonyOS 电子书阅读器

<p align="center">
  <img src="https://img.shields.io/badge/HarmonyOS-Next-blue" alt="HarmonyOS">
  <img src="https://img.shields.io/badge/ArkTS-6.0.2-green" alt="ArkTS">
  <img src="https://img.shields.io/badge/架构-MVVM-orange" alt="架构">
  <img src="https://img.shields.io/badge/进度-开发中-yellow" alt="进度">
</p>

## 📖 项目简介

AstroRead 是一款基于 **纯血鸿蒙 OpenHarmony Next** 开发的现代化电子书阅读器应用。采用 ArkTS + ArkUI 技术栈，提供流畅的阅读体验和丰富的功能特性。

## ✨ 核心特性

### 📚 阅读功能
- **多格式支持**: 支持网络小说、本地文件阅读
- **智能书源**: 可配置的书源规则解析系统
- **阅读定制**: 字体、字号、行距、主题等个性化设置
- **进度同步**: 自动保存阅读进度和书签

### 🎨 用户体验
- **主题系统**: 完整的亮色/暗黑主题支持
- **响应式布局**: 适配手机和平板设备
- **流畅动画**: 优化的翻页和过渡动画效果
- **离线阅读**: 支持章节缓存和离线阅读

### 🔧 技术特性
- **现代化架构**: MVVM 模式，清晰的代码分层
- **模块化设计**: 高度可扩展的组件化架构
- **性能优化**: 大文件加载优化，内存管理
- **完整测试**: 单元测试和集成测试覆盖

## 🏗️ 技术架构

### 技术栈
```yaml
前端框架: ArkTS + ArkUI
数据库: @ohos.data.relationalStore
网络请求: @ohos.net.http
状态管理: @State, @Prop, @Link 装饰器
构建工具: hvigor
测试框架: @ohos/hypium
```

### 项目结构
```
AstroRead/
├── AppScope/                    # 应用全局配置
├── entry/                       # 主模块
│   ├── src/main/
│   │   ├── ets/
│   │   │   ├── components/      # 公共组件
│   │   │   ├── entryability/    # 应用入口
│   │   │   ├── models/          # 数据模型
│   │   │   ├── pages/           # 页面组件
│   │   │   ├── styles/          # 样式和主题
│   │   │   ├── utils/           # 工具类
│   │   │   └── viewmodel/       # 视图模型
│   │   ├── resources/           # 资源文件
│   │   └── module.json5         # 模块配置
│   └── src/test/               # 测试代码
├── build-profile.json5          # 构建配置
├── oh-package.json5            # 依赖管理
└── hvigorfile.ts               # 构建脚本
```

## 🚀 快速开始

### 环境要求
- **DevEco Studio**: 4.0 或更高版本
- **HarmonyOS SDK**: 6.0.2(22) 或更高版本
- **Node.js**: 16.0 或更高版本

### 构建和运行
1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd AstroRead
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **构建项目**
   ```bash
   # 调试构建
   hvigor assembleDebug
   
   # 发布构建
   hvigor assembleRelease
   ```

4. **运行测试**
   ```bash
   # 运行单元测试
   hvigor test
   
   # 运行UI测试
   hvigor uiTest
   ```

## 📊 开发进度

### ✅ 已完成功能 (87%)

#### 基础架构 (100%)
- [x] 项目框架搭建和配置
- [x] ArkTS 开发环境配置
- [x] MVVM 架构设计实现
- [x] 模块化依赖管理

#### 数据层 (90%)
- [x] 关系型数据库设计
- [x] 完整的数据模型定义
- [x] DatabaseManager 数据库管理
- [x] 数据表 CRUD 操作

#### UI 组件层 (100%)
- [x] 完整的主题系统实现
- [x] 响应式布局适配
- [x] **极简底部导航栏** - 线性图标+文字轻质感设计（已修复构建错误）
- [x] 统一样式系统
- [x] **统一状态提示系统** - 优化所有页面的用户体验

#### 功能页面 (80%)
- [x] **书架页面** - 优化的状态提示和书籍管理
- [x] **搜索页面** - 优化的搜索功能和状态提示
- [x] **书源管理** - 优化的状态提示和书源配置
- [x] **设置页面** - 应用配置管理

### 🔄 进行中功能 (15%)

#### 阅读器核心 (40%)
- [ ] 阅读器页面完整实现
- [ ] 章节内容加载优化
- [ ] 翻页动画效果
- [ ] 阅读配置持久化

#### 高级功能 (30%)
- [ ] 书源导入/导出
- [ ] 数据备份恢复
- [ ] 书签管理功能
- [ ] 离线阅读优化

#### 测试覆盖 (20%)
- [ ] 核心功能单元测试
- [ ] UI 自动化测试
- [ ] 性能基准测试
- [ ] 兼容性测试

## 🛠️ 核心模块说明

### 数据库管理 (`DatabaseManager.ets`)
```typescript
// 使用 HarmonyOS relationalStore API
import relationalStore from '@ohos.data.relationalStore';

// 支持的表结构：
// - book_source: 书源配置
// - book: 书籍信息
// - chapter: 章节数据
// - read_config: 阅读配置
// - bookmark: 书签管理
```

### 网络管理 (`NetworkManager.ets`)
```typescript
// 支持的功能：
// - HTTP/HTTPS 请求
// - 流式数据处理
// - 书源规则解析
// - 内容净化处理
// - 错误重试机制
```

### 主题系统 (`ThemeManager.ets`)
```typescript
// 主题特性：
// - 动态主题切换
// - 系统主题跟随
// - 自定义主题支持
// - 组件级主题应用
```

### 统一状态提示系统

#### 搜索页面 (`SearchPage.ets`)
```typescript
// 状态管理：
// - 初始状态：搜索引导界面
// - 搜索中：加载动画反馈
// - 无结果：友好的空状态提示
// - 有结果：网格化书籍展示
// - 防抖搜索：优化性能体验
```

#### 书架页面 (`HomePage.ets`)
```typescript
// 状态管理：
// - 加载中：书籍加载动画
// - 空状态：无书籍的友好提示
// - 有书籍：网格/列表视图展示
// - 编辑模式：批量操作支持
```

#### 书源管理页面 (`BookSourcePage.ets`)
```typescript
// 状态管理：
// - 加载中：书源加载动画
// - 空状态：无书源的友好提示
// - 有书源：列表展示和操作
// - 导入功能：书源导入对话框
```

## 🧪 测试覆盖

项目采用完整的测试策略：

### 单元测试
- **模型测试**: 数据验证和业务逻辑
- **工具类测试**: 工具函数功能验证
- **ViewModel测试**: 业务逻辑单元测试

### 集成测试
- **页面测试**: UI 组件集成测试
- **API测试**: 网络和数据层集成
- **端到端测试**: 完整用户流程测试

### 测试命令
```bash
# 运行所有测试
hvigor test

# 运行特定测试套件
hvigor test --test-suite BookSourceParserTest

# 生成测试报告
hvigor test --report
```

## 🐛 已知问题

### 高优先级
- [ ] 阅读器翻页动画性能优化
- [ ] 大文件章节加载内存管理
- [ ] 网络请求超时处理机制

### 中优先级
- [ ] 书源规则解析兼容性
- [ ] 主题切换动画流畅性
- [ ] 数据库迁移策略

### 低优先级
- [ ] 国际化多语言支持
- [ ] 自定义主题扩展
- [ ] 插件化架构支持

## 🔄 近期改进 (2026年2月)

### 极简底部导航栏实现与修复
- ✅ **设计风格**: 线性图标+文字轻质感风格，阅读APP首选
- ✅ **底部背景**: 纯白/极浅灰，无阴影、无边框，极致干净
- ✅ **结构布局**: 线性图标在上，短文字在下，上下排布
- ✅ **选中状态**: 图标+文字统一主蓝色，底部加粗短圆角指示条
- ✅ **未选中状态**: 图标+文字统一浅灰/中灰，低饱和度，护眼不刺眼
- ✅ **图标设计**: 线性细图标（书架、放大镜、书源、设置），线条纤细
- ✅ **ArkTS 语法修复**: 修复 Builder 函数、const 声明等语法错误
- ✅ **组件清理**: 移除冗余的独立组件文件，集成到主页面

### 统一状态提示系统优化
- ✅ **搜索页面**: 替换外部图片生成服务，使用本地图标资源
- ✅ **书架页面**: 重构状态提示，优化加载和空状态体验
- ✅ **书源管理页面**: 改进状态指示，提供更好的用户反馈

### 状态管理增强
- ✅ **四种状态管理**: 初始/加载中/空状态/有内容的平滑过渡
- ✅ **防抖搜索**: 500ms 防抖优化，提升搜索性能
- ✅ **响应式布局**: 适配手机和平板设备
- ✅ **主题集成**: 完整的亮色/暗黑主题支持

### 技术架构改进
- ✅ **本地资源系统**: 创建统一的 SVG 图标库
- ✅ **状态机设计**: 清晰的状态管理架构
- ✅ **动画效果**: 流畅的状态切换动画
- ✅ **错误处理**: 完善的异常处理机制

### 性能优化
- ✅ **内存优化**: 移除外部图片加载，减少内存占用
- ✅ **网络优化**: 减少不必要的 API 调用
- ✅ **构建优化**: 修复编译错误，提升构建稳定性
- ✅ **用户体验**: 统一的状态提示设计语言

## 🤝 贡献指南

我们欢迎社区贡献！请遵循以下步骤：

1. **Fork 项目**
2. **创建功能分支** (`git checkout -b feature/AmazingFeature`)
3. **提交更改** (`git commit -m 'Add some AmazingFeature'`)
4. **推送到分支** (`git push origin feature/AmazingFeature`)
5. **开启 Pull Request**

### 开发规范
- 遵循 ArkTS 编码规范
- 编写完整的单元测试
- 更新相关文档
- 保持代码风格一致

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 📞 联系方式

- **项目维护者**: [陈甸]
- **问题反馈**: [GitHub Issues]
- **技术讨论**: [GitHub Discussions]

## 🙏 致谢

感谢所有为 AstroRead 项目做出贡献的开发者！

---

**最后更新**: 2026年2月6日  
**版本**: v0.9.0  
**状态**: 开发中